<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Document</title>
    <script src="https://unpkg.com/alpinejs" defer></script>
    <link href="https://cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>

<style type="text/css">


    /* ============ desktop view ============ */
    @media all and (min-width: 992px) {

        .sidebar li {
            position: relative;
        }

        .sidebar li .submenu {
            display: none;
            position: absolute;
            left: 100%;
            top: -7px;
            min-width: 240px;
        }

        [dir=rtl] .sidebar li .submenu {
            right: 100%;
            left: auto;
        }

        .sidebar li:hover {
            background: var(--bs-light);
        }

        .sidebar li:hover > .submenu {
            display: block;
        }

    }

    /* ============ desktop view .end// ============ */


    /* ============ small devices ============ */
    @media (max-width: 991px) {

        .sidebar .submenu, .sidebar .dropdown-menu {
            position: static !important;
            margin-left: 0.7rem;
            margin-right: 0.7rem;
            margin-bottom: .5rem;
        }
    }

    /* ============ small devices .end// ============ */


    .sidebar .nav-link {
        font-weight: 500;
        color: var(--bs-dark);
    }

    .sidebar .nav-link:hover {
        background: var(--bs-light);
        color: var(--bs-primary);
    }


</style>

<body class="bg-light" data-new-gr-c-s-check-loaded="14.1083.0" data-gr-ext-installed="">

<header class="section-header py-3">
    <div class="container">
        <h2>Категории</h2>
    </div>
</header> <!-- section-header.// -->

<div x-data="PageController"
     x-init="Container.initialize()"
     class="container">
    <section class="section-content py-3">
        <div class="row">
            <aside class="col-lg-3">
                <!-- ============= COMPONENT ============== -->
                <nav class="sidebar mt-3 card py-2 mb-4">
                    <ul class="nav flex-column">
                        <template x-for="category in Container.categories">
                            <li class="nav-item">
                                <a @click.prevent="console.log('asdfasfd')" x-bind:href="category.alias" x-text="category.name" class="nav-link"></a>
                                <ul x-show="category.child" class="submenu dropdown-menu">
                                    <template x-for="child in category.child">
                                        <li><a @click.prevent="console.log('asdfasfd')" x-bind:href="child.alias" x-text="child.name" class="nav-link"></a></li>
                                    </template>
                                </ul>
                            </li>
                        </template>
                    </ul>
                </nav>

                <a href="add.html" class="btn btn-primary">Доавить страницу</a>
                <!-- ============= COMPONENT END// ============== -->
            </aside>
            <main class="col-lg-9">
                <div class="row">
                    <template x-for="page in Container.pages">
                        <div class="col-md-6 mt-3">
                            <div class="card">
                                <div class="card-body">
                                    <h5 x-text="page.title" class="card-title"></h5>
                                    <h6 x-text="`Author: ${page?.author?.slug}`" class="card-subtitle mb-2 text-muted"></h6>
                                    <h6 x-text="`Category: ${page?.category?.name}`" class="card-subtitle mb-2 text-muted"></h6>
                                    <p x-text="page.body.slice(0, 500).concat('...')" class="card-text"></p>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </main>
        </div>
    </section>

</div><!-- container //  -->


<div style="position: static !important;"></div>
</body>

<body>


<script>
    document.addEventListener("alpine:init", () => {
        Alpine.data("PageController", () => {
            return new PageController()
        })
    })

    class PageController {
        CAT_LIST = "/category/api/menu"
        PAGES_LIST = "/pages/api/list"

        Container = {}
        categories = []
        pages = []

        constructor() {
            this.Container = this
        }

        initialize() {
            this.getCategories()
            this.getPages()
        }

        getCategories() {
            fetch(this.CAT_LIST).then(res => res.json())
                .then(res => this.categories = res)
        }

        getPages() {
            fetch(this.PAGES_LIST).then(res => res.json())
                .then(res => this.pages = res.result)
        }
    }

</script>
</body>
</html>
